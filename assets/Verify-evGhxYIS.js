import{a as f,r as u,u as E,b,e as y,f as v,t as d,j as t,Q as x}from"./index-CDJ0jnDt.js";import{l as N}from"./black-logo-KPU1N9jl.js";import{A as P,a as C}from"./AuthSupport-CWB7ohp4.js";function R({typeMain:c}){f.defaults.withCredentials=!0;const[i,m]=u.useState(new Array(6).fill("")),p=u.useRef(null),g=u.useRef(null),l=E(),n=b(),h=u.useCallback((r,e)=>{const s=r.target.value.replace(/[^0-9]/g,"");if(s.length<=1){const o=[...i];o[e]=s,m(o),s&&e<5&&document.getElementById(`code-input-${e+1}`).focus()}},[i]),j=r=>{r.preventDefault();const e=r.clipboardData.getData("text").trim();if(/^\d{6}$/.test(e)){const s=e.split("");m(s),document.getElementById("code-input-5").focus()}else d("error","Invalid code format. Please paste 6 digits.")},w=u.useCallback(r=>{var e;if(r.preventDefault(),c==="verify"){const s=i.join("");if(s.length===6){const o=f.post(y.verifyEmail,{code:s,email:n.state.email});v(o,{pending:"Verification in progress, please wait..",success:"Email verified successfully! ðŸŽ‰",error:"Failed to verify email, please try again!"},{position:"top-center"},()=>{p.current===!0&&l("/login")}),o.then(a=>{p.current=a.data.success}).catch(a=>{console.error(a)})}else d("error","Please enter all 6 digits.")}else{const s=i.join("");if(s.length===6){const o=f.post(y.verifyOtpPassword,{email:(e=n.state)==null?void 0:e.email,otp:s});v(o,{pending:"Reset password in progress, please wait..",success:"Reset password verified successfully! ðŸŽ‰",error:"Failed to verify reset password, please try again!"},{position:"top-center"},()=>{var a;g.current===!0&&l("/reset-password",{state:{messageNoEmail:(a=n.state)==null?void 0:a.email}})}),o.then(a=>{g.current=a.data.success}).catch(a=>{console.error(a)})}else d("error","Please enter all 6 digits.")}},[c,i,l,n.state]);return u.useEffect(()=>{c==="verify"&&!n.state?l("/login",{state:{messageNoEmail:"Email is missing. Please go back to the previous step and ensure your email is entered correctly!"}}):c==="verify-password"&&!n.state&&l("/recovery",{state:{messageNoEmail:"Email is missing. Please go back to the previous step and ensure your email is entered correctly!"}})},[l,n.state]),t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"verify",children:[t.jsx("div",{className:"verify-header",children:t.jsx(P,{type:c,classDiff:"verify"})}),t.jsxs("div",{className:"verify-content",children:[t.jsx(C,{logo:N,type:c,classDiff:"verify"}),t.jsxs("form",{className:"verify-content-core",onSubmit:w,children:[t.jsx("div",{className:"verify-content-core-wrapper",children:i.map((r,e)=>t.jsx("input",{id:`code-input-${e}`,className:"code-number",type:"text",maxLength:"1",value:r,onChange:s=>h(s,e),onKeyDown:s=>{s.key==="Backspace"&&!i[e]&&e>0&&document.getElementById(`code-input-${e-1}`).focus()},onPaste:j,autoComplete:"off"},e))}),t.jsx("button",{className:"verify-content-core-button",children:"Submit Code"})]})]})]}),t.jsx(x,{})]})}export{R as default};
