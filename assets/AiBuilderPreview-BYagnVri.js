import{a as p,r as s,m as Q,u as R,e as P,j as a,n as q,t as l,Q as G}from"./index-BLOQ8UXG.js";import{D as H}from"./AiBuilderSupport-CQgpAMnV.js";import{N as J,I as K,P as U,S as V,A as W,F as X}from"./Form-D3rNZNLK.js";import"./black-logo-KPU1N9jl.js";function se(){p.defaults.withCredentials=!0;const[A,C]=s.useState(null),[g,I]=s.useState([]),[r,B]=s.useState(null),[d,w]=s.useState({}),[f,E]=s.useState({}),[c,D]=s.useState(null),[n,$]=s.useState(null),{token:v,setAiBuilderLoader:j,isLoadingAiBuilder:L,dataElements:k,dataPages:F}=Q(),N=R(),h=s.useCallback(async()=>{try{j(!0);const t=await p.get(P.aiBuilderId,{headers:{Authorization:`Bearer ${v}`}}),u=t.data.data[0].ai_builder_id,[T,M]=await Promise.all([p.get(`${P.aiBuilderSectionsId}?id=${u}`),p.get(`${P.aiBuilderSupportsId}?id=${u}`)]),m=t.data.data[0],S=T.data.data,y=M.data.data.filter(e=>e.support_id==="2bff7888-e861-4341-869b-189af29ad3f8");C(m.site_title),D(m.color_id),$(m.font_id),I([...new Set(S.map(e=>e.page_id))]);const z=S.reduce((e,_)=>{const{page_id:o,section_id:b}=_;return e[o]||(e[o]=[]),e[o].includes(b)||e[o].push(b),e},{});w(z);const x=S.reduce((e,_)=>{const{page_id:o,section_id:b,style_design:O}=_;return e[o]||(e[o]={}),e[o][b]=O,e},{});Object.keys(x).forEach(e=>{x[e][y[0].support_id]=y[0].style_design}),E(x)}catch(t){console.error(t),N("/login",{replace:!0,state:{messageSessionExpired:"Session expired, Please login again."}})}finally{j(!1)}},[v]);s.useEffect(()=>{v&&h()},[v,h,N]),s.useEffect(()=>{B(g[0])},[g]);const i=s.useMemo(()=>f[r]||{},[f,r]);return s.useEffect(()=>{console.log(d),console.log(f),console.log(d[r])},[r,d,f]),a.jsxs(a.Fragment,{children:[L&&a.jsx(q,{}),a.jsxs("div",{className:"aibuilder-preview",children:[a.jsx(J,{activePages:g,dataPages:F,activeSections:d,siteTitle:A,currentPageId:r,setCurrentPageId:B,activeNavbar:i["2bff7888-e861-4341-869b-189af29ad3f8"],activeIntro:i["798f1ce0-b732-45a6-838e-f28e137243f7"],toastMessage:l,activeFonts:n,activeColors:c,isPreview:!0}),r!==null&&a.jsx("div",{className:"aibuilder-preview-section",children:k.filter(t=>{var u;return(u=d[r])==null?void 0:u.includes(t.section_id)}).map(t=>a.jsx(s.Fragment,{children:t.section_id==="798f1ce0-b732-45a6-838e-f28e137243f7"?a.jsx(K,{activeSections:d,currentPageId:r,activeIntro:i["798f1ce0-b732-45a6-838e-f28e137243f7"],activeNavbar:i["2bff7888-e861-4341-869b-189af29ad3f8"],toastMessage:l,activeColors:c,activeFonts:n}):t.section_id==="b42d4d56-d411-4aa8-ae01-52f0c406328a"?a.jsx(U,{activeProducts:i["b42d4d56-d411-4aa8-ae01-52f0c406328a"],activeNavbar:i["2bff7888-e861-4341-869b-189af29ad3f8"],toastMessage:l,activeColors:c,activeFonts:n}):t.section_id==="4fd1e0cc-06f3-4554-9f79-ce8e02db03c8"?a.jsx(V,{activeServices:i["4fd1e0cc-06f3-4554-9f79-ce8e02db03c8"],activeNavbar:i["2bff7888-e861-4341-869b-189af29ad3f8"],toastMessage:l,activeColors:c,activeFonts:n}):t.section_id==="1a988ed7-6ddb-44c1-8a9e-2dca26ebb0ed"?a.jsx(W,{activeAbout:i["1a988ed7-6ddb-44c1-8a9e-2dca26ebb0ed"],activeNavbar:i["2bff7888-e861-4341-869b-189af29ad3f8"],toastMessage:l,activeColors:c,activeFonts:n}):t.section_id==="2089ce88-93a7-4555-8d0d-7f88f1dc3a7e"?a.jsx(X,{activeForm:i["2089ce88-93a7-4555-8d0d-7f88f1dc3a7e"],activeNavbar:i["2bff7888-e861-4341-869b-189af29ad3f8"],toastMessage:l,activeColors:c,activeFonts:n}):a.jsx("div",{className:"no-element",children:t.name})},t.section_id))}),a.jsx(H,{dataPages:F,isPreview:!0})]}),a.jsx(G,{})]})}export{se as default};
