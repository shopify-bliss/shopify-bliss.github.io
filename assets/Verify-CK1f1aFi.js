import{a as f,r as i,u as w,b as x,d as l,e as y,t as d,f as t,Q as E}from"./index-CMOvAOI6.js";import{l as b}from"./black-logo-KPU1N9jl.js";import{A as P,a as C}from"./AuthSupport-BsZ_FME2.js";function R({typeMain:c}){f.defaults.withCredentials=!0;const[r,m]=i.useState(new Array(6).fill("")),p=i.useRef(null),g=i.useRef(null),n=w(),u=x(),v=i.useCallback((o,e)=>{const s=o.target.value.replace(/[^0-9]/g,"");if(s.length<=1){const a=[...r];a[e]=s,m(a),s&&e<5&&document.getElementById(`code-input-${e+1}`).focus()}},[r]),h=o=>{o.preventDefault();const e=o.clipboardData.getData("text").trim();if(/^\d{6}$/.test(e)){const s=e.split("");m(s),document.getElementById("code-input-5").focus()}else d("error","Invalid code format. Please paste 6 digits.")},j=i.useCallback(o=>{if(o.preventDefault(),c==="verify"){const e=r.join("");if(e.length===6){const s=f.post(l.verifyEmail,{code:e,email:u.state.email});y(s,{pending:"Verification in progress, please wait..",success:"Email verified successfully! ðŸŽ‰",error:"Failed to verify email, please try again!"},{position:"top-center"},()=>{p.current===!0&&n("/login")}),s.then(a=>{p.current=a.data.success}).catch(a=>{console.error(a)})}else d("error","Please enter all 6 digits.")}else{const e=r.join("");if(e.length===6){const s=f.post(l.otpPassword,{otp:e});y(s,{pending:"Reset password in progress, please wait..",success:"Reset password verified successfully! ðŸŽ‰",error:"Failed to verify reset password, please try again!"},{position:"top-center"},()=>{g.current===!0&&n("/login")}),s.then(a=>{g.current=a.data.success}).catch(a=>{console.error(a)})}else d("error","Please enter all 6 digits.")}},[c,r,l.verifyEmail,l.otpPassword,n]);return i.useEffect(()=>{u.state||n("/login",{state:{messageNoEmail:"Email is missing. Please go back to the previous step and ensure your email is entered correctly!"}})},[n,u.state]),t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"verify",children:[t.jsx("div",{className:"verify-header",children:t.jsx(P,{type:c,classDiff:"verify"})}),t.jsxs("div",{className:"verify-content",children:[t.jsx(C,{logo:b,type:c,classDiff:"verify"}),t.jsxs("form",{className:"verify-content-core",onSubmit:j,children:[t.jsx("div",{className:"verify-content-core-wrapper",children:r.map((o,e)=>t.jsx("input",{id:`code-input-${e}`,className:"code-number",type:"text",maxLength:"1",value:o,onChange:s=>v(s,e),onKeyDown:s=>{s.key==="Backspace"&&!r[e]&&e>0&&document.getElementById(`code-input-${e-1}`).focus()},onPaste:h,autoComplete:"off"},e))}),t.jsx("button",{className:"verify-content-core-button",children:"Submit Code"})]})]})]}),t.jsx(E,{})]})}export{R as default};
