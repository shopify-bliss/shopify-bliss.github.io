import{a as w,r as t,h as N,e as P,j as e,P as g}from"./index-BP31rb4T.js";import{d as E}from"./AuthSupport-C8noIWmd.js";import{a as A,u as F}from"./ValidationSchema-BwsmvZcF.js";function O(){w.defaults.withCredentials=!0;const[c,o]=t.useState({oldPassword:"",newPassword:""}),[i,m]=t.useState(!0),[u,p]=t.useState(!0),[d,b]=t.useState({length:!1,uppercase:!1,lowercase:!1,number:!1,special:!1}),{toastPromise:f,toastMessage:h}=N(),n=t.useCallback(r=>{const{name:s,value:l}=r.target;s==="newPassword"&&b({length:l.length>=8,uppercase:/[A-Z]/.test(l),lowercase:/[a-z]/.test(l),number:/[0-9]/.test(l),special:/[@$!%*?&#^()_\-+=]/.test(l)}),o(x=>({...x,[s]:l}))},[b,o]),a=t.useCallback(r=>{r.preventDefault(),A.validate(c,{abortEarly:!1}).then(()=>{const s=w.put(P.updatePassword,c);f(s,{pending:"Reset password on progress, please wait..!",success:"Reset password has been successfully updated!",error:"Failed to reset password!"},{autoClose:2500,position:"top-center"}),s.then(l=>{console.log(l.data)}).catch(l=>{console.error("Error updating password:",l)})}).catch(s=>{s.inner.forEach(l=>{h("error",l.message)})})},[c,f,h]);return e.jsxs("form",{className:"core",onSubmit:a,children:[e.jsxs("div",{className:"core-input",children:[e.jsxs("div",{className:"core-input-group core-input-pw",children:[e.jsx("label",{htmlFor:"oldPassword",children:"Current Password"}),e.jsx("input",{type:`${i?"password":"text"}`,id:"oldPassword",name:"oldPassword",autoComplete:"off",onChange:n}),e.jsx("span",{className:"material-symbols-outlined",onClick:()=>m(!i),children:i?"visibility_off":"visibility"}),e.jsx("div",{className:"input-border"})]}),e.jsxs("div",{className:"core-input-group core-input-pw",children:[e.jsx("label",{htmlFor:"newPassword",children:"Set New Password"}),e.jsx("input",{type:`${u?"password":"text"}`,id:"newPassword",name:"newPassword",autoComplete:"off",onChange:n}),e.jsx("span",{className:"material-symbols-outlined",onClick:()=>p(!u),children:u?"visibility_off":"visibility"}),e.jsx("div",{className:"input-border"})]})]}),e.jsx(E,{validationPassword:d}),e.jsx("button",{className:"core-button",type:"submit",children:"Save"})]})}const $=[{image:"bear.png"},{image:"bee.png"},{image:"butterfly.png"},{image:"chicken.png"},{image:"elephant.png"},{image:"hedgehog.png"},{image:"hippo.png"},{image:"koala.png"},{image:"ladybug.png"},{image:"lion.png"},{image:"llama.png"},{image:"meerkat.png"},{image:"monkey.png"},{image:"panda.png"},{image:"parrot.png"},{image:"penguin.png"},{image:"polar-bear.png"},{image:"puffer-fish.png"},{image:"sea-lion.png"},{image:"sloth.png"},{image:"snake.png"},{image:"spider.png"},{image:"tiger.png"},{image:"turtle.png"},{image:"weasel.png"}];function C({onClose:c}){w.defaults.withCredentials=!0;const{user:o,toastPromise:i,toastMessage:m,token:u,fetchDashboardData:p}=N(),[d,b]=t.useState(o==null?void 0:o.avatar),[f,h]=t.useState(!1),[n,a]=t.useState({username:"",phoneNumber:""}),r=t.useRef(null),s=t.useCallback(v=>{r.current&&!r.current.contains(v.target)&&h(!1)},[r]);t.useEffect(()=>(f?document.addEventListener("mousedown",s):document.removeEventListener("mousedown",s),()=>{document.removeEventListener("mousedown",s)}),[f,s]),t.useEffect(()=>{o&&a({username:o.username,phoneNumber:o.phone_number})},[o]);const l=t.useCallback(v=>{const{name:j,value:y}=v.target;a({...n,[j]:y})},[n]),x=t.useCallback(v=>{v.preventDefault();const j={avatar:d,username:n.username,phoneNumber:n.phoneNumber};F.validate(j,{abortEarly:!1}).then(()=>{const y=w.put(P.userId,j,{headers:{Authorization:`Bearer ${u}`}});i(y,{pending:"Updating profile data on progress, please wait..!",success:"Data has been successfully updated!",error:"Failed to update data!"},{autoClose:3e3,position:"top-center"},()=>{c(),p()})}).catch(y=>{y.inner.forEach(D=>{m("error",D.message)})})},[d,n,u,i,c,p,m]);return e.jsxs("form",{className:"core",onSubmit:x,children:[e.jsxs("div",{className:"core-avatar",children:[e.jsxs("div",{className:"core-avatar-selected",children:[e.jsx("img",{src:`/avatar/${d}`,alt:"Avatar's User"}),e.jsx("span",{onClick:()=>h(!0),children:"Select Avatar"})]}),f&&e.jsx("div",{className:"core-avatar-list",ref:r,children:$.map((v,j)=>e.jsx("img",{src:`/avatar/${v.image}`,alt:"Avatar List",onClick:()=>{b(v.image),h(!1)}},j))})]}),e.jsx("div",{className:"core-role"}),e.jsxs("div",{className:"core-input",children:[e.jsxs("div",{className:"core-input-group",children:[e.jsx("label",{htmlFor:"username",children:"Username"}),e.jsx("input",{type:"text",id:"username",name:"username",autoComplete:"off",value:n.username,onChange:l}),e.jsx("div",{className:"input-border"})]}),e.jsxs("div",{className:"core-input-group",children:[e.jsx("label",{htmlFor:"phoneNumber",children:"Phone Number"}),e.jsx("input",{type:"number",id:"phoneNumber",name:"phoneNumber",autoComplete:"off",value:n.phoneNumber,onChange:l}),e.jsx("div",{className:"input-border"})]})]}),e.jsx("button",{className:"core-button",type:"submit",children:"Save"})]})}C.propTypes={onClose:g.func};function k({type:c="form",titleModal:o,descModal:i,children:m,onClose:u=null,onOpen:p=null}){return p?e.jsx(e.Fragment,{children:e.jsx("div",{className:"overlay-modal-dashboard",onClick:u,children:c==="form"?e.jsxs("div",{className:"modal-dashboard",onClick:d=>{d.stopPropagation()},children:[e.jsx("span",{className:"modal-dashboard-title",children:o}),e.jsx("span",{className:"material-symbols-outlined modal-dashboard-close",onClick:u,children:"close"}),m]}):e.jsxs("div",{className:"confirm-dashboard",onClick:d=>{d.stopPropagation()},children:[e.jsx("span",{className:"confirm-dashboard-title",children:o}),e.jsx("span",{className:"confirm-dashboard-desc",children:i}),m]})})}):null}k.propTypes={type:g.string,titleModal:g.string,descModal:g.string,children:g.node,onClose:g.func,onOpen:g.func};function S({setCurrentSubmenu:c}){w.defaults.withCredentials=!0;const[o,i]=t.useState(new Array(6).fill("")),m=t.useRef(null),{toastMessage:u,toastPromise:p,user:d}=N(),b=t.useCallback((n,a)=>{const r=n.target.value.replace(/[^0-9]/g,"");if(r.length<=1){const s=[...o];s[a]=r,i(s),r&&a<5&&document.getElementById(`code-input-${a+1}`).focus()}},[o]),f=n=>{n.preventDefault();const a=n.clipboardData.getData("text").trim();if(/^\d{6}$/.test(a)){const r=a.split("");i(r),document.getElementById("code-input-5").focus()}else u("error","Invalid code format. Please paste 6 digits.")},h=t.useCallback(n=>{n.preventDefault();const a=o.join("");if(a.length===6){const r=w.post(P.verifyOtpPassword,{email:d.email,otp:a});p(r,{pending:"Reset password in progress, please wait..",success:"Reset password verified successfully! ðŸŽ‰",error:"Failed to verify reset password, please try again!"},{position:"top-center"},()=>{m.current===!0&&c("d86578b0-4497-4d43-bdad-0f50af1011aa")}),r.then(s=>{m.current=s.data.success}).catch(s=>{console.error(s)})}else u("error","Please enter all 6 digits.")},[o,c,p,u,d.email]);return e.jsxs("form",{className:"recovery-dashboard",onSubmit:h,children:[e.jsx("div",{className:"recovery-dashboard-text",children:"Please check your email inbox for a 6-digit verification code we have sent to your email address. Enter the code in the field below to confirm your email and complete the reset password process."}),e.jsx("div",{className:"recovery-dashboard-wrapper",children:o.map((n,a)=>e.jsx("input",{id:`code-input-${a}`,className:"code-number",type:"text",maxLength:"1",value:n,onChange:r=>b(r,a),onKeyDown:r=>{r.key==="Backspace"&&!o[a]&&a>0&&document.getElementById(`code-input-${a-1}`).focus()},onPaste:f,autoComplete:"off"},a))}),e.jsx("button",{className:"recovery-dashboard-button",children:"Submit Code"})]})}S.propTypes={setCurrentSubmenu:g.func};function _({onClose:c,onOpen:o}){w.defaults.withCredentials=!0;const[i,m]=t.useState(f.filter(s=>s.menu_id==="6556df8f-7cd6-4848-b39f-1e6ab4973311"&&s.default===!0)[0].sub_menu_id),[u,p]=t.useState(!1),[d,b]=t.useState(!1),{submenus:f,toastPromise:h,user:n}=N(),a=t.useCallback(s=>{s==="d86578b0-4497-4d43-bdad-0f50af1011aa"&&!d?p(!0):m(s)},[d]),r=t.useCallback(s=>{s.preventDefault(),m("a14736d9-7bcc-4eef-9be3-2015223cc5ed");const l=w.post(P.sendOtpPassword,{email:n.email});h(l,{pending:"Sending OTP password on progress, please wait..!",success:"OTP password sent successfully.",error:"Failed to send OTP password."},{position:"top-center",autoClose:2500},()=>{p(!1),b(!0),setTimeout(()=>{b(!1)},3e4)}),l.then(x=>{console.log(x.data)}).catch(x=>{console.error(x)})},[h,n.email]);return o?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"overlay-modal-menu",onClick:()=>{c()},children:e.jsxs("div",{className:"modal-menu",onClick:s=>{s.stopPropagation()},children:[e.jsxs("div",{className:"modal-menu-nav",children:[e.jsx("div",{className:"modal-menu-nav-title",children:"Menu"}),f.filter(s=>s.menu_id==="6556df8f-7cd6-4848-b39f-1e6ab4973311"&&s.sub_menu_id!=="a14736d9-7bcc-4eef-9be3-2015223cc5ed").map(s=>e.jsx(e.Fragment,{children:e.jsxs("div",{className:`modal-menu-nav-item ${s.sub_menu_id===i?"active":""}`,onClick:()=>a(s.sub_menu_id),children:[e.jsx("div",{className:"name",children:s.name}),e.jsx("div",{className:"border-effect"})]},s.sub_menu_id)})),d&&e.jsx(e.Fragment,{children:f.filter(s=>s.menu_id==="6556df8f-7cd6-4848-b39f-1e6ab4973311"&&s.sub_menu_id==="a14736d9-7bcc-4eef-9be3-2015223cc5ed").map(s=>e.jsx(e.Fragment,{children:e.jsxs("div",{className:`modal-menu-nav-item ${s.sub_menu_id===i?"active":""}`,onClick:()=>a(s.sub_menu_id),children:[e.jsx("div",{className:"name",children:s.name}),e.jsx("div",{className:"border-effect"})]},s.sub_menu_id)}))})]}),e.jsxs("div",{className:"modal-menu-content",children:[e.jsxs("div",{className:"header",children:[e.jsxs("span",{className:"header-title",children:["Profile â€”"," ",i==="0977a7d1-7ee9-4b68-8e3d-edad0ef87a56"?"Bio":i==="d86578b0-4497-4d43-bdad-0f50af1011aa"?"Password":"Verify OTP"]}),e.jsx("span",{className:"header-close material-symbols-outlined",onClick:c,children:"close"})]}),i==="0977a7d1-7ee9-4b68-8e3d-edad0ef87a56"?e.jsx(C,{onClose:c}):i==="d86578b0-4497-4d43-bdad-0f50af1011aa"&&d?e.jsx(O,{}):e.jsx(S,{setCurrentSubmenu:m})]})]})}),e.jsx(k,{type:"confirm",titleModal:"Are you sure you want to reset password?",descModal:"If you sure want to change your password, please check your email for a verification code.",onClose:()=>{p(!1)},onOpen:u,children:e.jsxs("div",{className:"confirm-dashboard-action",children:[e.jsx("div",{className:"cancel",onClick:()=>{p(!1)},children:"cancel"}),e.jsx("div",{className:"confirm",onClick:r,children:"reset"})]})})]}):null}_.propTypes={onClose:g.func,onOpen:g.bool};const B=Object.freeze(Object.defineProperty({__proto__:null,default:_},Symbol.toStringTag,{value:"Module"}));export{k as M,_ as P,B as a};
