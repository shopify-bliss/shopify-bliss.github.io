import{a as v,r as o,h as y,e as j,j as e}from"./index-CDJ0jnDt.js";import{d as k}from"./AuthSupport-CWB7ohp4.js";import{a as S,u as P}from"./ValidationSchema-fCLfNoAd.js";function _(){v.defaults.withCredentials=!0;const[d,n]=o.useState({oldPassword:"",newPassword:""}),[c,m]=o.useState(!0),[u,h]=o.useState(!0),[l,g]=o.useState({length:!1,uppercase:!1,lowercase:!1,number:!1,special:!1}),{toastPromise:b,toastMessage:p}=y(),s=o.useCallback(r=>{const{name:i,value:a}=r.target;i==="newPassword"&&g({length:a.length>=8,uppercase:/[A-Z]/.test(a),lowercase:/[a-z]/.test(a),number:/[0-9]/.test(a),special:/[@$!%*?&#^()_\-+=]/.test(a)}),n(w=>({...w,[i]:a}))},[g,n]),t=o.useCallback(r=>{r.preventDefault(),S.validate(d,{abortEarly:!1}).then(()=>{const i=v.put(j.updatePassword,d);b(i,{pending:"Reset password on progress, please wait..!",success:"Reset password has been successfully updated!",error:"Failed to reset password!"},{autoClose:2500,position:"top-center"}),i.then(a=>{console.log(a.data)}).catch(a=>{console.error("Error updating password:",a)})}).catch(i=>{i.inner.forEach(a=>{p("error",a.message)})})},[d,b,p]);return e.jsxs("form",{className:"core",onSubmit:t,children:[e.jsxs("div",{className:"core-input",children:[e.jsxs("div",{className:"core-input-group core-input-pw",children:[e.jsx("label",{htmlFor:"oldPassword",children:"Current Password"}),e.jsx("input",{type:`${c?"password":"text"}`,id:"oldPassword",name:"oldPassword",autoComplete:"off",onChange:s}),e.jsx("span",{className:"material-symbols-outlined",onClick:()=>m(!c),children:c?"visibility_off":"visibility"}),e.jsx("div",{className:"input-border"})]}),e.jsxs("div",{className:"core-input-group core-input-pw",children:[e.jsx("label",{htmlFor:"newPassword",children:"Set New Password"}),e.jsx("input",{type:`${u?"password":"text"}`,id:"newPassword",name:"newPassword",autoComplete:"off",onChange:s}),e.jsx("span",{className:"material-symbols-outlined",onClick:()=>h(!u),children:u?"visibility_off":"visibility"}),e.jsx("div",{className:"input-border"})]})]}),e.jsx(k,{validationPassword:l}),e.jsx("button",{className:"core-button",type:"submit",children:"Save"})]})}const D=[{image:"bear.png"},{image:"bee.png"},{image:"butterfly.png"},{image:"chicken.png"},{image:"elephant.png"},{image:"hedgehog.png"},{image:"hippo.png"},{image:"koala.png"},{image:"ladybug.png"},{image:"lion.png"},{image:"llama.png"},{image:"meerkat.png"},{image:"monkey.png"},{image:"panda.png"},{image:"parrot.png"},{image:"penguin.png"},{image:"polar-bear.png"},{image:"puffer-fish.png"},{image:"sea-lion.png"},{image:"sloth.png"},{image:"snake.png"},{image:"spider.png"},{image:"tiger.png"},{image:"turtle.png"},{image:"weasel.png"}];function E({onClose:d}){v.defaults.withCredentials=!0;const{user:n,toastPromise:c,toastMessage:m,token:u,fetchDashboardData:h}=y(),[l,g]=o.useState(n==null?void 0:n.avatar),[b,p]=o.useState(!1),[s,t]=o.useState({username:"",phoneNumber:""}),r=o.useRef(null),i=o.useCallback(f=>{r.current&&!r.current.contains(f.target)&&p(!1)},[r]);o.useEffect(()=>(b?document.addEventListener("mousedown",i):document.removeEventListener("mousedown",i),()=>{document.removeEventListener("mousedown",i)}),[b]),o.useEffect(()=>{n&&t({username:n.username,phoneNumber:n.phone_number})},[n]);const a=o.useCallback(f=>{const{name:x,value:N}=f.target;t({...s,[x]:N})},[s]),w=o.useCallback(f=>{f.preventDefault();const x={avatar:l,username:s.username,phoneNumber:s.phoneNumber};P.validate(x,{abortEarly:!1}).then(()=>{const N=v.put(j.userId,x,{headers:{Authorization:`Bearer ${u}`}});c(N,{pending:"Updating profile data on progress, please wait..!",success:"Data has been successfully updated!",error:"Failed to update data!"},{autoClose:3e3,position:"top-center"},()=>{d(),h()})}).catch(N=>{N.inner.forEach(C=>{m("error",C.message)})})},[P,l,s,j.userId,u,c,d,h,m]);return e.jsxs("form",{className:"core",onSubmit:w,children:[e.jsxs("div",{className:"core-avatar",children:[e.jsxs("div",{className:"core-avatar-selected",children:[e.jsx("img",{src:`/avatar/${l}`,alt:"Avatar's User"}),e.jsx("span",{onClick:()=>p(!0),children:"Select Avatar"})]}),b&&e.jsx("div",{className:"core-avatar-list",ref:r,children:D.map((f,x)=>e.jsx("img",{src:`/avatar/${f.image}`,alt:"Avatar List",onClick:()=>{g(f.image),p(!1)}},x))})]}),e.jsx("div",{className:"core-role"}),e.jsxs("div",{className:"core-input",children:[e.jsxs("div",{className:"core-input-group",children:[e.jsx("label",{htmlFor:"username",children:"Username"}),e.jsx("input",{type:"text",id:"username",name:"username",autoComplete:"off",value:s.username,onChange:a}),e.jsx("div",{className:"input-border"})]}),e.jsxs("div",{className:"core-input-group",children:[e.jsx("label",{htmlFor:"phoneNumber",children:"Phone Number"}),e.jsx("input",{type:"number",id:"phoneNumber",name:"phoneNumber",autoComplete:"off",value:s.phoneNumber,onChange:a}),e.jsx("div",{className:"input-border"})]})]}),e.jsx("button",{className:"core-button",type:"submit",children:"Save"})]})}function A({type:d="form",titleModal:n,descModal:c,children:m,onClose:u=null,onOpen:h=null}){return h?e.jsx(e.Fragment,{children:e.jsx("div",{className:"overlay-modal-dashboard",onClick:u,children:d==="form"?e.jsxs("div",{className:"modal-dashboard",onClick:l=>{l.stopPropagation()},children:[e.jsx("span",{className:"modal-dashboard-title",children:n}),e.jsx("span",{className:"material-symbols-outlined modal-dashboard-close",onClick:u,children:"close"}),m]}):e.jsxs("div",{className:"confirm-dashboard",onClick:l=>{l.stopPropagation()},children:[e.jsx("span",{className:"confirm-dashboard-title",children:n}),e.jsx("span",{className:"confirm-dashboard-desc",children:c}),m]})})}):null}function F({setCurrentSubmenu:d}){v.defaults.withCredentials=!0;const[n,c]=o.useState(new Array(6).fill("")),m=o.useRef(null),{toastMessage:u,toastPromise:h,user:l}=y(),g=o.useCallback((s,t)=>{const r=s.target.value.replace(/[^0-9]/g,"");if(r.length<=1){const i=[...n];i[t]=r,c(i),r&&t<5&&document.getElementById(`code-input-${t+1}`).focus()}},[n]),b=s=>{s.preventDefault();const t=s.clipboardData.getData("text").trim();if(/^\d{6}$/.test(t)){const r=t.split("");c(r),document.getElementById("code-input-5").focus()}else u("error","Invalid code format. Please paste 6 digits.")},p=o.useCallback(s=>{s.preventDefault();const t=n.join("");if(t.length===6){const r=v.post(j.verifyOtpPassword,{email:l.email,otp:t});h(r,{pending:"Reset password in progress, please wait..",success:"Reset password verified successfully! ðŸŽ‰",error:"Failed to verify reset password, please try again!"},{position:"top-center"},()=>{m.current===!0&&d("d86578b0-4497-4d43-bdad-0f50af1011aa")}),r.then(i=>{m.current=i.data.success}).catch(i=>{console.error(i)})}else u("error","Please enter all 6 digits.")},[n,d,h,u]);return e.jsxs("form",{className:"recovery-dashboard",onSubmit:p,children:[e.jsx("div",{className:"recovery-dashboard-text",children:"Please check your email inbox for a 6-digit verification code we have sent to your email address. Enter the code in the field below to confirm your email and complete the reset password process."}),e.jsx("div",{className:"recovery-dashboard-wrapper",children:n.map((s,t)=>e.jsx("input",{id:`code-input-${t}`,className:"code-number",type:"text",maxLength:"1",value:s,onChange:r=>g(r,t),onKeyDown:r=>{r.key==="Backspace"&&!n[t]&&t>0&&document.getElementById(`code-input-${t-1}`).focus()},onPaste:b,autoComplete:"off"},t))}),e.jsx("button",{className:"recovery-dashboard-button",children:"Submit Code"})]})}function O({onClose:d,onOpen:n}){if(!n)return null;v.defaults.withCredentials=!0;const{submenus:c,toastPromise:m,token:u,user:h}=y(),[l,g]=o.useState(c.filter(a=>a.menu_id==="6556df8f-7cd6-4848-b39f-1e6ab4973311"&&a.default===!0)[0].sub_menu_id),[b,p]=o.useState(!1),[s,t]=o.useState(!1),r=o.useCallback(a=>{a==="d86578b0-4497-4d43-bdad-0f50af1011aa"&&!s?p(!0):g(a)},[s]),i=o.useCallback(a=>{a.preventDefault(),g("a14736d9-7bcc-4eef-9be3-2015223cc5ed");const w=v.post(j.sendOtpPassword,{email:h.email});m(w,{pending:"Sending OTP password on progress, please wait..!",success:"OTP password sent successfully.",error:"Failed to send OTP password."},{position:"top-center",autoClose:2500},()=>{p(!1),t(!0),setTimeout(()=>{t(!1)},3e4)}),w.then(f=>{console.log(f.data)}).catch(f=>{console.error(f)})},[j.sendOtpPassword,u,m]);return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"overlay-modal-menu",onClick:()=>{d()},children:e.jsxs("div",{className:"modal-menu",onClick:a=>{a.stopPropagation()},children:[e.jsxs("div",{className:"modal-menu-nav",children:[e.jsx("div",{className:"modal-menu-nav-title",children:"Menu"}),c.filter(a=>a.menu_id==="6556df8f-7cd6-4848-b39f-1e6ab4973311"&&a.sub_menu_id!=="a14736d9-7bcc-4eef-9be3-2015223cc5ed").map(a=>e.jsx(e.Fragment,{children:e.jsxs("div",{className:`modal-menu-nav-item ${a.sub_menu_id===l?"active":""}`,onClick:()=>r(a.sub_menu_id),children:[e.jsx("div",{className:"name",children:a.name}),e.jsx("div",{className:"border-effect"})]},a.sub_menu_id)})),s&&e.jsx(e.Fragment,{children:c.filter(a=>a.menu_id==="6556df8f-7cd6-4848-b39f-1e6ab4973311"&&a.sub_menu_id==="a14736d9-7bcc-4eef-9be3-2015223cc5ed").map(a=>e.jsx(e.Fragment,{children:e.jsxs("div",{className:`modal-menu-nav-item ${a.sub_menu_id===l?"active":""}`,onClick:()=>r(a.sub_menu_id),children:[e.jsx("div",{className:"name",children:a.name}),e.jsx("div",{className:"border-effect"})]},a.sub_menu_id)}))})]}),e.jsxs("div",{className:"modal-menu-content",children:[e.jsxs("div",{className:"header",children:[e.jsxs("span",{className:"header-title",children:["Profile â€”"," ",l==="0977a7d1-7ee9-4b68-8e3d-edad0ef87a56"?"Bio":l==="d86578b0-4497-4d43-bdad-0f50af1011aa"?"Password":"Verify OTP"]}),e.jsx("span",{className:"header-close material-symbols-outlined",onClick:d,children:"close"})]}),l==="0977a7d1-7ee9-4b68-8e3d-edad0ef87a56"?e.jsx(E,{onClose:d}):l==="d86578b0-4497-4d43-bdad-0f50af1011aa"&&s?e.jsx(_,{}):e.jsx(F,{setCurrentSubmenu:g})]})]})}),e.jsx(A,{type:"confirm",titleModal:"Are you sure you want to reset password?",descModal:"If you sure want to change your password, please check your email for a verification code.",onClose:()=>{p(!1)},onOpen:b,children:e.jsxs("div",{className:"confirm-dashboard-action",children:[e.jsx("div",{className:"cancel",onClick:()=>{p(!1)},children:"cancel"}),e.jsx("div",{className:"confirm",onClick:i,children:"reset"})]})})]})}const B=Object.freeze(Object.defineProperty({__proto__:null,default:O},Symbol.toStringTag,{value:"Module"}));export{A as M,O as P,B as a};
