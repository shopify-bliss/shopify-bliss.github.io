import{a as g,r as l,h as S,e as v,j as e,L as U,u as J}from"./index-De2FbLnl.js";import{L as K}from"./LayoutDashboard-C7Sf0rDK.js";import{H as R}from"./SupportDashboard-Blnc6hOX.js";import{M as P,S as L,A as V,R as O}from"./ValidationSchema-ym9zi7kY.js";import{M as E}from"./Profile-BqJ2OnwU.js";import"./AiBuilderSupport-DafnIiDd.js";import"./black-logo-KPU1N9jl.js";import"./AuthSupport-JXJjKzqc.js";function z({type:t,onOpen:c,onClose:s,refreshData:o,menuId:d}){g.defaults.withCredentials=!0;const[r,a]=l.useState({name:"",url:""}),{toastMessage:m,toastPromise:j,token:n}=S();l.useEffect(()=>{c&&t==="create"?a({name:"",url:""}):c&&t==="update"&&g.get(`${v.menusId}?id=${d}`).then(u=>{a(u.data.data[0])}).catch(u=>{console.error("Error fetching menu data:",u)})},[c,t,d,v]);const f=u=>{const{name:i,value:h}=u.target;a({...r,[i]:h})},b=l.useCallback(u=>{u.preventDefault(),t==="create"?P.validate(r,{abortEarly:!1}).then(()=>{const i=g.post(v.menus,r,{headers:{Authorization:`Bearer ${n}`}});j(i,{pending:"Adding menu data on progress, please wait..!",success:"Data has been successfully added!",error:"Failed to add data!"},{autoClose:2500,position:"top-center"},()=>{s(),o()}),i.catch(h=>{console.error("Error adding menu data:",h)})}).catch(i=>{i.inner.forEach(h=>{m("error",h.message)})}):P.validate(r,{abortEarly:!1}).then(()=>{const i=g.put(`${v.menus}?id=${d}`,r,{headers:{Authorization:`Bearer ${n}`}});j(i,{pending:"Updating menu data on progress, please wait..!",success:"Data has been successfully updated!",error:"Failed to update data!"},{autoClose:2500,position:"top-center"},()=>{s(),o()}),i.catch(h=>{console.error("Error updating menu data:",h)})}).catch(i=>{i.inner.forEach(h=>{m("error",h.message)})})},[P,r,s,o,m,j,d,n,v]),x=l.useCallback(u=>{u.preventDefault();const i=g.delete(`${v.menus}?id=${d}`,{headers:{Authorization:`Bearer ${n}`}});j(i,{pending:"deleting menu data on progress, please wait..!",success:"Data has been successfully deleted!",error:"Failed to delete data!"},{autoClose:2500,position:"top-center"},()=>{s(),o()}),i.catch(h=>{console.error("Error deleting menu data:",h)})},[d,n,s,o]);return e.jsx(e.Fragment,{children:t==="delete"?e.jsx(E,{onClose:s,onOpen:c,type:"confirm",titleModal:"Are you sure you want to delete this?",descModal:"Your content will be permanently deleted. This can't be undone.",children:e.jsxs("div",{className:"confirm-dashboard-action",children:[e.jsx("div",{className:"cancel",onClick:s,children:"cancel"}),e.jsx("div",{className:"confirm",onClick:x,children:"delete"})]})}):e.jsx(E,{titleModal:t==="create"?"Insert Menu Data":"Update Menu Data",onOpen:c,onClose:s,children:e.jsxs("form",{className:"modal-dashboard-form",onSubmit:b,children:[e.jsxs("div",{className:"modal-dashboard-form-group",children:[e.jsxs("label",{htmlFor:"name",children:["Menu name ",e.jsx("span",{children:"(Required)"})]}),e.jsx("input",{type:"text",id:"name",name:"name",placeholder:"Access Management",value:r.name,onChange:f})]}),e.jsxs("div",{className:"modal-dashboard-form-group",children:[e.jsxs("label",{htmlFor:"url",children:["Menu url ",e.jsx("span",{children:"(Required)"})]}),e.jsx("input",{type:"text",id:"url",name:"url",placeholder:"access-management",value:r.url,onChange:f})]}),e.jsx("button",{type:"submit",children:"Submit"})]})})})}function T({isLoadingDashboard:t,menus:c,setMenuId:s,setIsUpdateModalOpen:o,setIsDeleteModalOpen:d,type:r}){return e.jsxs(e.Fragment,{children:[t&&e.jsx("div",{className:"loader-pages",children:e.jsx("div",{className:"loader-pages-item"})}),r==="grid"?e.jsx("div",{className:"menu-man-grid",children:c.map(a=>e.jsxs("div",{className:"item",children:[e.jsx("div",{className:"item-name",children:a.name}),e.jsx(U,{to:`/${a.url}`,className:"item-url",children:a.url}),e.jsxs("div",{className:"item-action",children:[e.jsx("span",{className:"material-symbols-rounded item-action-edit",onClick:()=>{o(!0),s(a.menu_id)},children:"edit_square"}),e.jsx("span",{className:"material-symbols-rounded item-action-delete",onClick:()=>{d(!0),s(a.menu_id)},children:"delete"})]})]},a.menu_id))}):e.jsxs("div",{className:"menu-man-list",children:[e.jsxs("div",{className:"head",children:[e.jsx("div",{className:"head-col",children:"No"}),e.jsx("div",{className:"head-col",children:"Name"}),e.jsx("div",{className:"head-col",children:"Url"}),e.jsx("div",{className:"head-col",children:"Action"})]}),c.map((a,m)=>e.jsxs("div",{className:"body",children:[e.jsx("div",{className:"body-col",children:m+1}),e.jsx("div",{className:"body-col",children:a.name}),e.jsx(U,{to:`/${a.url}`,className:"body-col",children:a.url}),e.jsxs("div",{className:"body-col",children:[e.jsx("span",{className:"material-symbols-rounded edit",onClick:()=>{o(!0),s(a.menu_id)},children:"edit_square"}),e.jsx("span",{className:"material-symbols-rounded delete",onClick:()=>{d(!0),s(a.menu_id)},children:"delete"})]})]},a.menu_id))]})]})}function Q(){g.defaults.withCredentials=!0;const[t,c]=l.useState("grid"),[s,o]=l.useState(!1),[d,r]=l.useState(!1),[a,m]=l.useState(!1),[j,n]=l.useState(null),{menus:f,fetchDashboardData:b,isLoadingDashboard:x}=S(),u=l.useCallback(i=>{c(i)},[]);return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"menu-man",children:[e.jsx(R,{className:"menu-man",title:"Menu Management â€” Menus",activeDisplay:t,handleDisplayChange:u,setIsCreateModalOpen:o}),t==="grid"?e.jsx(T,{isLoadingDashboard:x,menus:f,setMenuId:n,setIsUpdateModalOpen:r,setIsDeleteModalOpen:m,type:"grid"}):e.jsx(T,{isLoadingDashboard:x,menus:f,setMenuId:n,setIsUpdateModalOpen:r,setIsDeleteModalOpen:m,type:"list"}),e.jsx(z,{type:"create",onOpen:s,onClose:()=>o(!1),refreshData:b}),e.jsx(z,{type:"update",onOpen:d,onClose:()=>r(!1),refreshData:b,menuId:j}),e.jsx(z,{type:"delete",onOpen:a,onClose:()=>m(!1),refreshData:b,menuId:j})]})})}function B({type:t,onOpen:c,onClose:s,refreshData:o,submenuId:d}){g.defaults.withCredentials=!0;const[r,a]=l.useState(!1),[m,j]=l.useState(""),[n,f]=l.useState(!1),[b,x]=l.useState(""),u=l.useRef(null),{toastMessage:i,toastPromise:h,menus:_,token:y}=S(),M=l.useCallback(N=>{u.current&&!u.current.contains(N.target)&&a(!1)},[u]);l.useEffect(()=>(r?document.addEventListener("mousedown",M):document.removeEventListener("mousedown",M),()=>{document.removeEventListener("mousedown",M)}),[r]),l.useEffect(()=>{c&&t==="create"?(x(""),j(""),f(!1)):c&&t==="update"&&g.get(`${v.submenusId}?id=${d}`,{headers:{Authorization:`Bearer ${y}`}}).then(N=>{x(N.data.data.name),j(N.data.data.menu_id),f(N.data.data.default)}).catch(N=>{console.error("Error fetching submenu data:",N)})},[c,t,d,y,v.submenusId]);const k=l.useCallback(N=>{N.preventDefault();const A={menuID:m,name:b,defaults:n};t==="create"?L.validate(A,{abortEarly:!1}).then(()=>{const C=g.post(v.submenus,A,{headers:{Authorization:`Bearer ${y}`}});h(C,{pending:"Adding submenu data on progress, please wait..!",success:"Data has been successfully added!",error:"Failed to add data!"},{autoClose:2500,position:"top-center"},()=>{s(),o()}),C.catch(p=>{console.error("Error adding submenu data:",p)})}).catch(C=>{C.inner.forEach(p=>{i("error",p.message)})}):L.validate(A,{abortEarly:!1}).then(()=>{const C=g.put(`${v.submenus}?id=${d}`,A,{headers:{Authorization:`Bearer ${y}`}});h(C,{pending:"Updating submenu data on progress, please wait..!",success:"Data has been successfully updated!",error:"Failed to update data!"},{autoClose:2500,position:"top-center"},()=>{s(),o()}),C.catch(p=>{console.error("Error updating submenu data:",p)})}).catch(C=>{C.inner.forEach(p=>{i("error",p.message)})})},[L,b,m,n,s,o,i,h,y,d,v.submenus]),D=l.useCallback(N=>{N.preventDefault();const A=g.delete(`${v.submenus}?id=${d}`,{headers:{Authorization:`Bearer ${y}`}});h(A,{pending:"deleting submenu data on progress, please wait..!",success:"Data has been successfully deleted!",error:"Failed to delete data!"},{autoClose:2500,position:"top-center"},()=>{s(),o()}),A.catch(C=>{console.error("Error deleting submenu data:",C)})},[y,d,s,o,v.submenus,h]);return e.jsx(e.Fragment,{children:t==="delete"?e.jsx(E,{onClose:s,onOpen:c,type:"confirm",titleModal:"Are you sure you want to delete this?",descModal:"Your content will be permanently deleted. This can't be undone.",children:e.jsxs("div",{className:"confirm-dashboard-action",children:[e.jsx("div",{className:"cancel",onClick:s,children:"cancel"}),e.jsx("div",{className:"confirm",onClick:D,children:"delete"})]})}):e.jsx(E,{titleModal:t==="create"?"Insert Submenu Data":"Update Submenu Data",onOpen:c,onClose:s,children:e.jsxs("form",{className:"modal-dashboard-form",onSubmit:k,children:[e.jsxs("div",{className:"modal-dashboard-form-group",children:[e.jsxs("div",{className:"label",children:["Menu Parent ",e.jsx("span",{children:"(Required)"})]}),e.jsxs("div",{className:"select-default",onClick:()=>a(!0),children:[e.jsx("div",{className:"text",children:m===""?"Select Menu Parent":_.filter(N=>N.menu_id===m).map(N=>N.name)}),e.jsx("span",{className:`material-symbols-outlined ${r?"default-closed":""}`,children:"south_east"})]}),r&&e.jsx("div",{className:"select-list",ref:u,children:_.filter(N=>N.menu_id!==m).map(N=>e.jsx("div",{className:"select-list-item",onClick:()=>{j(N.menu_id),a(!1)},children:e.jsx("div",{className:"name",children:N.name})},N.menu_id))})]}),e.jsxs("div",{className:"modal-dashboard-form-group",children:[e.jsxs("label",{htmlFor:"name",children:["Submenu Name ",e.jsx("span",{children:"(Required)"})]}),e.jsx("input",{type:"text",id:"name",name:"name",placeholder:"Analytics XX",value:b,onChange:N=>x(N.target.value)})]}),e.jsxs("div",{className:"modal-dashboard-form-group",children:[e.jsxs("div",{className:"label",children:["Setting Default ",e.jsx("span",{children:"(Required)"})]}),e.jsxs("div",{className:"check-default",onClick:()=>f(!n),children:[e.jsx("span",{class:"material-symbols-outlined",children:n?"task_alt":"circle"}),e.jsx("div",{className:"text",children:n?"True":"Null"})]})]}),e.jsx("button",{type:"submit",children:"Submit"})]})})})}function Y({isLoadingDashboard:t,submenus:c,setSubmenuId:s,setIsUpdateModalOpen:o,setIsDeleteModalOpen:d,type:r}){return e.jsxs(e.Fragment,{children:[t&&e.jsx("div",{className:"loader-pages",children:e.jsx("div",{className:"loader-pages-item"})}),r==="grid"?e.jsx("div",{className:"submenu-man-grid",children:c.map(a=>e.jsxs("div",{className:"item",children:[e.jsx("div",{className:"item-name",children:a.name}),e.jsx(U,{className:"item-menu",to:`/${a.menus.url}`,children:a.menus.url}),e.jsxs("div",{className:"item-action",children:[a.default===!0?e.jsx(e.Fragment,{children:e.jsxs("div",{className:"item-action-default",children:[e.jsx("span",{className:"material-symbols-outlined item-action-default-icon",children:"settings"}),e.jsx("span",{className:"item-action-default-text",children:"Default"})]})}):null,e.jsx("span",{className:"material-symbols-rounded item-action-edit",onClick:()=>{o(!0),s(a.sub_menu_id)},children:"edit_square"}),e.jsx("span",{className:"material-symbols-rounded item-action-delete",onClick:()=>{d(!0),s(a.sub_menu_id)},children:"delete"})]})]},a.sub_menu_id))}):e.jsxs("div",{className:"submenu-man-list",children:[e.jsxs("div",{className:"head",children:[e.jsx("div",{className:"head-col",children:"No"}),e.jsx("div",{className:"head-col",children:"Name"}),e.jsx("div",{className:"head-col",children:"Menu"}),e.jsx("div",{className:"head-col",children:"Default"}),e.jsx("div",{className:"head-col",children:"Action"})]}),c.map((a,m)=>e.jsxs("div",{className:"body",children:[e.jsx("div",{className:"body-col",children:m+1}),e.jsx("div",{className:"body-col",children:a.name}),e.jsx("div",{className:"body-col",children:a.menus.name}),e.jsx("div",{className:"body-col",children:a.default===!0?e.jsx("span",{className:"default",children:"Default"}):e.jsx("span",{className:"nope",children:"-"})}),e.jsxs("div",{className:"body-col",children:[e.jsx("span",{className:"material-symbols-rounded edit",onClick:()=>{o(!0),s(a.sub_menu_id)},children:"edit_square"}),e.jsx("span",{className:"material-symbols-rounded delete",onClick:()=>{d(!0),s(a.sub_menu_id)},children:"delete"})]})]},a.sub_menu_id))]})]})}function W(){g.defaults.withCredentials=!0;const[t,c]=l.useState("grid"),[s,o]=l.useState(!1),[d,r]=l.useState(!1),[a,m]=l.useState(!1),[j,n]=l.useState(null),{submenus:f,fetchDashboardData:b,isLoadingDashboard:x}=S(),u=l.useCallback(i=>{c(i)},[]);return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"submenu-man",children:[e.jsx(R,{className:"submenu-man",title:"Menu Management â€” Submenus",activeDisplay:t,handleDisplayChange:u,setIsCreateModalOpen:o}),t==="grid"?e.jsx(Y,{isLoadingDashboard:x,submenus:f,setSubmenuId:n,setIsUpdateModalOpen:r,setIsDeleteModalOpen:m,type:"grid"}):e.jsx(Y,{isLoadingDashboard:x,submenus:f,setSubmenuId:n,setIsUpdateModalOpen:r,setIsDeleteModalOpen:m,type:"list"}),e.jsx(B,{type:"create",onOpen:s,onClose:()=>o(!1),refreshData:b}),e.jsx(B,{type:"update",onOpen:d,onClose:()=>r(!1),refreshData:b,submenuId:j}),e.jsx(B,{type:"delete",onOpen:a,onClose:()=>m(!1),refreshData:b,submenuId:j})]})})}function H({type:t,onOpen:c,onClose:s,refreshData:o,accessId:d,roles:r}){g.defaults.withCredentials=!0;const[a,m]=l.useState(!1),[j,n]=l.useState(!1),[f,b]=l.useState(""),[x,u]=l.useState(""),i=l.useRef(null),h=l.useRef(null),{toastMessage:_,toastPromise:y,menus:M,token:k,fetchDashboardData:D}=S(),N=l.useCallback(p=>{i.current&&!i.current.contains(p.target)?m(!1):h.current&&!h.current.contains(p.target)&&n(!1)},[i,h]);l.useEffect(()=>(a||j?document.addEventListener("mousedown",N):document.removeEventListener("mousedown",N),()=>{document.removeEventListener("mousedown",N)}),[a,j,N]),l.useEffect(()=>{c&&t==="create"&&(u(""),b(""))},[c,t]);const A=l.useCallback(p=>{p.preventDefault();const w={menuID:f,roleID:x};V.validate(w,{abortEarly:!1}).then(()=>{const $=g.post(v.accessManagement,w,{headers:{Authorization:`Bearer ${k}`}});y($,{pending:"Adding access data on progress, please wait..!",success:"Data has been successfully added!",error:"Failed to add data!"},{autoClose:2500,position:"top-center"},()=>{s(),D()}),$.catch(F=>{console.error("Error adding access data:",F)})}).catch($=>{$.inner.forEach(F=>{_("error",F.message)})})},[V,x,f,s,D,k,d,_,y]),C=l.useCallback(p=>{p.preventDefault();const w=g.delete(`${v.accessManagement}?id=${d}`,{headers:{Authorization:`Bearer ${k}`}});y(w,{pending:"deleting access data on progress, please wait..!",success:"Data has been successfully deleted!",error:"Failed to delete data!"},{autoClose:2500,position:"top-center"},()=>{s(),D()}),w.catch($=>{console.error("Error deleting access data:",$)})},[k,y,d,s,D]);return e.jsx(e.Fragment,{children:t==="delete"?e.jsx(E,{onClose:s,onOpen:c,type:"confirm",titleModal:"Are you sure you want to delete this?",descModal:"Your content will be permanently deleted. This can't be undone.",children:e.jsxs("div",{className:"confirm-dashboard-action",children:[e.jsx("div",{className:"cancel",onClick:s,children:"cancel"}),e.jsx("div",{className:"confirm",onClick:C,children:"delete"})]})}):e.jsx(E,{titleModal:"Insert Access Data",onOpen:c,onClose:s,children:e.jsxs("form",{className:"modal-dashboard-form",onSubmit:A,children:[e.jsxs("div",{className:"modal-dashboard-form-group",children:[e.jsxs("div",{className:"label",children:["Role ",e.jsx("span",{children:"(Required)"})]}),e.jsxs("div",{className:"select-default",onClick:()=>n(!0),children:[e.jsx("div",{className:"text",children:x===""?"Choose Role":r.filter(p=>p.role_id===x).map(p=>p.role_name)}),e.jsx("span",{className:`material-symbols-outlined ${j?"default-closed":""}`,children:"south_east"})]}),j&&e.jsx("div",{className:"select-list no-more",ref:h,children:r.filter(p=>p.role_id!==x).map(p=>e.jsx("div",{className:"select-list-item",onClick:()=>{u(p.role_id),n(!1)},children:e.jsx("div",{className:"name",children:p.role_name})},p.role_id))})]}),e.jsxs("div",{className:"modal-dashboard-form-group",children:[e.jsxs("div",{className:"label",children:["Menu ",e.jsx("span",{children:"(Required)"})]}),e.jsxs("div",{className:"select-default",onClick:()=>m(!0),children:[e.jsx("div",{className:"text",children:f===""?"Choose Menu":M.filter(p=>p.menu_id===f).map(p=>p.name)}),e.jsx("span",{className:`material-symbols-outlined ${a?"default-closed":""}`,children:"south_east"})]}),a&&e.jsx("div",{className:"select-list",ref:i,children:M.filter(p=>p.menu_id!==f).map(p=>e.jsx("div",{className:"select-list-item",onClick:()=>{b(p.menu_id),m(!1)},children:e.jsx("div",{className:"name",children:p.name})},p.menu_id))})]}),e.jsx("button",{type:"submit",children:"Submit"})]})})})}function X({accessMenus:t,setAccessId:c,setIsDeleteModalOpen:s,type:o,menus:d,activeRole:r,handleActiveRole:a,roles:m,isLoadingDashboard:j}){return e.jsxs(e.Fragment,{children:[j&&e.jsx("div",{className:"loader-pages",children:e.jsx("div",{className:"loader-pages-item"})}),e.jsxs("div",{className:"access-man-wrapper",children:[e.jsx("div",{className:"access-man-roles",children:m.length>0?m.map(n=>e.jsx("div",{className:`role ${r===n.role_id?"active":""}`,onClick:()=>a(n.role_id),children:n.role_name},n.role_id)):null}),o==="grid"?e.jsx("div",{className:"access-man-grid",children:d.map(n=>{const f=t.find(x=>x.menu_id===n.menu_id&&x.role_id===r),b=!!f;return e.jsxs("div",{className:"item",children:[e.jsx("div",{className:"item-name",children:n.name}),e.jsx("span",{className:"material-symbols-outlined item-check",children:b?"task_alt":"circle"}),e.jsx("div",{className:"item-action",children:b&&e.jsx("span",{className:"material-symbols-rounded item-action-delete",onClick:()=>{s(!0),c(f.access_id)},children:"delete"})})]},n.menu_id)})}):e.jsxs("div",{className:"access-man-list",children:[e.jsxs("div",{className:"head",children:[e.jsx("div",{className:"head-col",children:"No"}),e.jsx("div",{className:"head-col",children:"Menu"}),e.jsx("div",{className:"head-col",children:"Access"}),e.jsx("div",{className:"head-col",children:"Action"})]}),d.map((n,f)=>{const b=t.find(u=>u.menu_id===n.menu_id&&u.role_id===r),x=!!b;return e.jsxs("div",{className:"body",children:[e.jsx("div",{className:"body-col",children:f+1}),e.jsx("div",{className:"body-col",children:n.name}),e.jsx("div",{className:"body-col material-symbols-outlined",children:x?"task_alt":"circle"}),e.jsx("div",{className:"body-col",children:x&&e.jsx("span",{className:"material-symbols-rounded delete",onClick:()=>{s(!0),c(b.access_id)},children:"delete"})})]},n.menu_id)})]})]})]})}function Z(){g.defaults.withCredentials=!0;const[t,c]=l.useState("3de65f44-6341-4b4d-8d9f-c8ca3ea80b80"),[s,o]=l.useState([]),[d,r]=l.useState("list"),[a,m]=l.useState(!1),[j,n]=l.useState(!1),[f,b]=l.useState(null),{accessMenus:x,menus:u,token:i,isLoadingDashboard:h,setDashboardLoader:_}=S(),y=l.useCallback(D=>{r(D)},[]),M=l.useCallback(D=>{c(D)},[]),k=l.useCallback(async()=>{_(!0);try{const D=await g.get(v.role,{headers:{Authorization:`Bearer ${i}`}});console.log(D.data.data),o(D.data.data)}catch(D){console.error(D)}finally{_(!1)}},[i,_]);return l.useEffect(()=>{k()},[k]),e.jsx(e.Fragment,{children:e.jsxs("div",{className:"access-man",children:[e.jsx(R,{className:"access-man",title:"Menu Management â€” Access Menu",activeDisplay:d,handleDisplayChange:y,setIsCreateModalOpen:m}),d==="grid"?e.jsx(X,{roles:s,isLoadingDashboard:h,accessMenus:x,setAccessId:b,setIsDeleteModalOpen:n,type:"grid",menus:u,activeRole:t,handleActiveRole:M}):e.jsx(X,{roles:s,isLoadingDashboard:h,accessMenus:x,setAccessId:b,setIsDeleteModalOpen:n,type:"list",menus:u,activeRole:t,handleActiveRole:M}),e.jsx(H,{type:"create",onOpen:a,onClose:()=>m(!1),roles:s}),e.jsx(H,{type:"delete",onOpen:j,onClose:()=>n(!1),accessId:f,roles:s})]})})}function q({type:t,onOpen:c,onClose:s,refreshData:o,roleId:d}){g.defaults.withCredentials=!0;const[r,a]=l.useState({roleName:""}),{toastMessage:m,toastPromise:j,token:n}=S();l.useEffect(()=>{c&&t==="create"?a({roleName:""}):c&&t==="update"&&g.get(`${v.roleId}?id=${d}`,{headers:{Authorization:`Bearer ${n}`}}).then(u=>{console.log(u.data.data),a({roleName:u.data.data.role_name})}).catch(u=>{console.error("Error fetching role data:",u)})},[c,t,d,n,v]);const f=u=>{const{name:i,value:h}=u.target;a({...r,[i]:h})},b=l.useCallback(u=>{u.preventDefault(),t==="create"?O.validate(r,{abortEarly:!1}).then(()=>{const i=g.post(v.role,r,{headers:{Authorization:`Bearer ${n}`}});j(i,{pending:"Adding role data on progress, please wait..!",success:"Data has been successfully added!",error:"Failed to add data!"},{autoClose:2500,position:"top-center"},()=>{s(),o()}),i.catch(h=>{console.error("Error adding role data:",h)})}).catch(i=>{i.inner.forEach(h=>{m("error",h.message)})}):O.validate(r,{abortEarly:!1}).then(()=>{const i=g.put(`${v.role}?id=${d}`,r,{headers:{Authorization:`Bearer ${n}`}});j(i,{pending:"Updating role data on progress, please wait..!",success:"Data has been successfully updated!",error:"Failed to update data!"},{autoClose:2500,position:"top-center"},()=>{s(),o()}),i.catch(h=>{console.error("Error updating role data:",h)})}).catch(i=>{i.inner.forEach(h=>{m("error",h.message)})})},[O,r,n,s,o,m,j,d,v]),x=l.useCallback(u=>{u.preventDefault();const i=g.delete(`${v.role}?id=${d}`,{headers:{Authorization:`Bearer ${n}`}});j(i,{pending:"deleting role data on progress, please wait..!",success:"Data has been successfully deleted!",error:"Failed to delete data!"},{autoClose:2500,position:"top-center"},()=>{s(),o()}),i.catch(h=>{console.error("Error deleting role data:",h)})},[d,n,s,o,j,v]);return e.jsx(e.Fragment,{children:t==="delete"?e.jsx(E,{onClose:s,onOpen:c,type:"confirm",titleModal:"Are you sure you want to delete this?",descModal:"Your content will be permanently deleted. This can't be undone.",children:e.jsxs("div",{className:"confirm-dashboard-action",children:[e.jsx("div",{className:"cancel",onClick:s,children:"cancel"}),e.jsx("div",{className:"confirm",onClick:x,children:"delete"})]})}):e.jsx(E,{titleModal:t==="create"?"Insert Role Data":"Update Role Data",onOpen:c,onClose:s,children:e.jsxs("form",{className:"modal-dashboard-form",onSubmit:b,children:[e.jsxs("div",{className:"modal-dashboard-form-group",children:[e.jsxs("label",{htmlFor:"roleName",children:["Role name ",e.jsx("span",{children:"(Required)"})]}),e.jsx("input",{type:"text",id:"roleName",name:"roleName",placeholder:"Admin",value:r.roleName,onChange:f})]}),e.jsx("button",{type:"submit",children:"Submit"})]})})})}function G({isLoadingDashboard:t,roles:c,setRoleId:s,setIsUpdateModalOpen:o,setIsDeleteModalOpen:d,type:r}){return e.jsxs(e.Fragment,{children:[t&&e.jsx("div",{className:"loader-pages",children:e.jsx("div",{className:"loader-pages-item"})}),r==="grid"?e.jsx("div",{className:"role-man-grid",children:c.map(a=>e.jsxs("div",{className:"item",children:[e.jsx("div",{className:"item-name",children:a.role_name}),e.jsxs("div",{className:"item-action",children:[e.jsx("span",{className:"material-symbols-rounded item-action-edit",onClick:()=>{o(!0),s(a.role_id)},children:"edit_square"}),e.jsx("span",{className:"material-symbols-rounded item-action-delete",onClick:()=>{d(!0),s(a.role_id)},children:"delete"})]})]},a.role_id))}):e.jsxs("div",{className:"role-man-list",children:[e.jsxs("div",{className:"head",children:[e.jsx("div",{className:"head-col",children:"No"}),e.jsx("div",{className:"head-col",children:"Name"}),e.jsx("div",{className:"head-col",children:"Action"})]}),c.map((a,m)=>e.jsxs("div",{className:"body",children:[e.jsx("div",{className:"body-col",children:m+1}),e.jsx("div",{className:"body-col",children:a.role_name}),e.jsxs("div",{className:"body-col",children:[e.jsx("span",{className:"material-symbols-rounded edit",onClick:()=>{o(!0),s(a.role_id)},children:"edit_square"}),e.jsx("span",{className:"material-symbols-rounded delete",onClick:()=>{d(!0),s(a.role_id)},children:"delete"})]})]},a.role_id))]})]})}function I(){g.defaults.withCredentials=!0;const[t,c]=l.useState([]),[s,o]=l.useState("grid"),[d,r]=l.useState(!1),[a,m]=l.useState(!1),[j,n]=l.useState(!1),[f,b]=l.useState(null),{fetchDashboardData:x,token:u,isLoadingDashboard:i,setDashboardLoader:h}=S(),_=l.useCallback(M=>{o(M)},[]),y=l.useCallback(async()=>{h(!0);try{const M=await g.get(v.role,{headers:{Authorization:`Bearer ${u}`}});c(M.data.data)}catch(M){console.error("Error fetching roles:",M)}finally{h(!1)}},[u,v]);return l.useEffect(()=>{y()},[y]),e.jsx(e.Fragment,{children:e.jsxs("div",{className:"role-man",children:[e.jsx(R,{className:"role-man",title:"Role Management â€” Roles",activeDisplay:s,handleDisplayChange:_,setIsCreateModalOpen:r}),s==="grid"?e.jsx(G,{isLoadingDashboard:i,roles:t,setRoleId:b,setIsUpdateModalOpen:m,setIsDeleteModalOpen:n,type:"grid"}):e.jsx(G,{isLoadingDashboard:i,roles:t,setRoleId:b,setIsUpdateModalOpen:m,setIsDeleteModalOpen:n,type:"list"}),e.jsx(q,{type:"create",onOpen:d,onClose:()=>r(!1),refreshData:x}),e.jsx(q,{type:"update",onOpen:a,onClose:()=>m(!1),refreshData:x,roleId:f}),e.jsx(q,{type:"delete",onOpen:j,onClose:()=>n(!1),refreshData:x,roleId:f})]})})}function ce(){const{submenuPage:t,accessMenus:c,user:s}=S(),o=J();return l.useEffect(()=>{const d=setTimeout(()=>{(c==null?void 0:c.some(a=>a.role_id===(s==null?void 0:s.role_id)&&a.menu_id==="b37d4e96-87b0-4480-805e-562ccd798338"))===!1&&o("/403",{replace:!0})},1e4);return()=>clearTimeout(d)},[c,s,o]),e.jsx(e.Fragment,{children:e.jsxs(K,{children:[t==="access"&&e.jsx(Z,{}),t==="menu"&&e.jsx(Q,{}),t==="submenu"&&e.jsx(W,{}),t==="role"&&e.jsx(I,{})]})})}export{ce as default};
