import{j as e,L as S,r as t,u as H,a as I,b as W,c as z,t as w,d as U,e as B,Q as O}from"./index-B1L2C_zm.js";import{l as T}from"./black-logo-KPU1N9jl.js";import{u as A,a as L,s as q}from"./ValidationSchema-D4biATao.js";import{C as J,j as K}from"./index--JkIgoLm.js";const Q="/assets/google-CPEPVHln.png",Y="/assets/facebook-Cq3j-Ek1.png",Z="/assets/whatsapp%20(1)-UD0SVKSJ.png";function X({type:n}){return e.jsxs(e.Fragment,{children:[e.jsxs(S,{to:"/",className:"auth-header-back",children:[e.jsx("span",{className:"material-symbols-outlined",children:"chevron_backward"}),e.jsx("div",{className:"text",children:"Back"})]}),n==="signup"?e.jsx(S,{className:"auth-header-link",to:"/login",children:"Log in"}):e.jsx(S,{className:"auth-header-link",to:"/signup",children:"Create Account"})]})}function M({logo:n,type:i}){return e.jsxs("div",{className:"auth-content-title",children:[e.jsx("img",{className:"logo",src:n,alt:"Shopify Bliss Logo"}),i==="signup"?e.jsx("div",{className:"text",children:"Create Your Account"}):e.jsxs("div",{className:"text",children:["Log into ",e.jsx("span",{children:"shopify bliss"})]})]})}function ee({handleForm:n,handleChange:i,values:a,hidePassword:x,setHidePassword:F,validationPassword:p,type:j,phoneCodes:y,selectedCode:P,setSelectedCode:E}){const[f,v]=t.useState(!1),m=t.useRef(null),{search:d,setSearch:u}=H(),g=t.useCallback(s=>{m&&!m.current.contains(s.target)&&v(!1)},[m]);t.useEffect(()=>(f?document.addEventListener("mousedown",g):document.removeEventListener("mousedown",g),()=>{document.removeEventListener("mousedown",g)}),[f]);const b=t.useCallback(s=>{E(s),v(!1)},[]),C=t.useCallback(s=>{u(s.target.value)},[]);return e.jsxs("form",{className:"form",onSubmit:n,children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"email",children:"Email Address"}),e.jsx("input",{className:"form-group-input",type:"text",id:"email",name:"email",autoComplete:"email",placeholder:"example@gmail.com",onChange:i,value:a.email}),e.jsx("div",{className:"input-border"})]}),j==="signup"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"username",children:"Username"}),e.jsx("input",{className:"form-group-input",type:"text",id:"username",name:"username",autoComplete:"name",placeholder:"example is me",onChange:i,value:a.username}),e.jsx("div",{className:"input-border"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"phone",children:"Phone Number"}),e.jsxs("div",{className:"phone-wrapper-loan",children:[e.jsxs("div",{className:"phone-code",children:[e.jsx("div",{className:"phone-code-default",onClick:()=>v(!0),children:y.filter(s=>s.valueCodes===P).map((s,h)=>{const k=s.flag;return e.jsxs(t.Fragment,{children:[e.jsx("div",{className:"image",children:e.jsx("img",{src:k,alt:s.name})}),e.jsx("div",{className:"code",children:s.codes}),e.jsx("span",{className:"material-symbols-rounded",children:"arrow_drop_down"})]},h)})}),f?e.jsx(e.Fragment,{children:e.jsxs("div",{className:"phone-code-list",ref:m,children:[e.jsx("div",{className:"phone-code-list-search",children:e.jsxs("div",{className:"search-country",children:[e.jsx("span",{className:"material-symbols-rounded",children:"search"}),e.jsx("input",{className:"search-country-input",type:"text",onChange:C,placeholder:"Search country"})]})}),y.filter(s=>{const h=d.toLowerCase();return s.name.toLowerCase().includes(h)||s.codes.includes(h)}).map((s,h)=>{const k=s.flag;return e.jsxs("div",{className:"phone-code-list-item",onClick:()=>b(s.valueCodes),children:[e.jsx("div",{className:"image",children:e.jsx("img",{src:k,alt:s.name})}),e.jsxs("div",{className:"desc",children:[e.jsx("div",{className:"desc-name",children:s.name}),e.jsxs("div",{className:"desc-code",children:["(",s.codes,")"]})]})]},h)})]})}):""]}),e.jsx("input",{className:"form-group-input",type:"number",id:"phone",name:"phone",autoComplete:"tel",placeholder:"81234567890",onChange:i,value:a.phone})]}),e.jsx("div",{className:"input-border"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"password",children:"Password"}),e.jsx("input",{className:"form-group-input",type:x?"password":"text",id:"password",name:"password",autoComplete:"current-password",placeholder:"password",onChange:i,value:a.password}),e.jsx("span",{className:"material-symbols-outlined",onClick:()=>F(!x),children:x?"visibility_off":"visibility"}),e.jsx("div",{className:"input-border"})]}),j==="signup"&&e.jsxs("div",{className:"validation-password",children:[e.jsxs("div",{className:`item ${p.length?"done":""}`,children:[e.jsx("span",{className:"material-symbols-rounded",children:"check_circle"}),e.jsx("div",{className:"item-text",children:"Password should be 8 chars minimum."})]}),e.jsxs("div",{className:`item ${p.lowercase?"done":""}`,children:[e.jsx("span",{className:"material-symbols-rounded",children:"check_circle"}),e.jsx("div",{className:"item-text",children:"Password must contain at least one lowercase letter."})]}),e.jsxs("div",{className:`item ${p.uppercase?"done":""}`,children:[e.jsx("span",{className:"material-symbols-rounded",children:"check_circle"}),e.jsx("div",{className:"item-text",children:"Password must contain at least one uppercase letter."})]}),e.jsxs("div",{className:`item ${p.number?"done":""}`,children:[e.jsx("span",{className:"material-symbols-rounded",children:"check_circle"}),e.jsx("div",{className:"item-text",children:"Password must contain at least one number."})]}),e.jsxs("div",{className:`item ${p.special?"done":""}`,children:[e.jsx("span",{className:"material-symbols-rounded",children:"check_circle"}),e.jsx("div",{className:"item-text",children:"Password must contain at least one special character."})]})]}),e.jsx("button",{type:"submit",className:"form-submit",disabled:j==="signup"?!a.email||!a.password||!a.username:!a.email||!a.password,children:j==="signup"?"Sign up":"Log in"})]})}function se({toastDevelop:n}){return e.jsxs("div",{className:"integration",children:[e.jsxs("button",{className:"integration-item",onClick:()=>{n("continue with WhatsApp")},children:[e.jsx("img",{className:"icon",src:Z,alt:"WhatsApp's Logo"}),e.jsx("span",{className:"text",children:"Continue with WhatsApp"})]}),e.jsxs(S,{className:"integration-item",to:A.loginGoogle,children:[e.jsx("img",{className:"icon",src:Q,alt:"Google's Logo"}),e.jsx("span",{className:"text",children:"Continue with Google"})]}),e.jsxs("button",{className:"integration-item",onClick:()=>{n("continue with Facebook")},children:[e.jsx("img",{className:"icon",src:Y,alt:"Facebook's Logo"}),e.jsx("span",{className:"text",children:"Continue with Facebook"})]})]})}function ce({typeMain:n}){L.defaults.withCredentials=!0;const i=new J(null,{path:"/"}),[a,x]=t.useState({email:"",username:"",phone:"",password:""}),[F,p]=t.useState([]),[j,y]=t.useState(!0),[P,E]=t.useState({length:!1,uppercase:!1,lowercase:!1,number:!1,special:!1}),[f,v]=t.useState(62),m=t.useRef(null),d=I(),u=W(),[g]=z(),b=g.get("message"),C=g.get("shopify-bliss"),s=g.get("role");t.useEffect(()=>{if(b){w("success",b,{position:"top-center"});const o=new URLSearchParams(window.location.search);o.delete("message");const r=o.toString()?`${window.location.pathname}?${o.toString()}`:window.location.pathname;window.history.replaceState({},document.title,r)}},[b]),t.useEffect(()=>{if(C&&s){i.set("shopify-bliss",C);const o=new URLSearchParams(window.location.search);o.delete("shopify-bliss"),o.delete("role");const r=o.toString()?`${window.location.pathname}?${o.toString()}`:window.location.pathname;window.history.replaceState({},document.title,r),s==="admin"?d("/dashboard",{state:{messageLoginGoogle:"Login successfully!"}}):s==="customer"&&d("/profile",{state:{messageLoginGoogle:"Login successfully!"}})}},[C,s,i,d]),t.useEffect(()=>{L.get("https://restcountries.com/v3.1/all").then(o=>{const r=o.data;console.log(r);const N=r.filter(l=>l.idd&&l.idd.root).map(l=>{const $=l.flags.png,G=l.name.common,_=l.idd.root.replace("+",""),R=l.idd.suffixes,V=`+${_}${R[0]}`,D=parseInt(`${_}${R[0]}`);return{flag:$,name:G,codes:V,valueCodes:D}}).sort((l,$)=>l.name.localeCompare($.name));p(N)}).catch(o=>{console.error(o)})},[]);const h=t.useCallback(o=>{const{name:r,value:c}=o.target;x(N=>({...N,[r]:c})),r==="password"&&E({length:c.length>=8,uppercase:/[A-Z]/.test(c),lowercase:/[a-z]/.test(c),number:/[0-9]/.test(c),special:/[@$!%*?&#^()_\-+=]/.test(c)})},[]),k=t.useCallback(o=>{if(o.preventDefault(),n==="signup")q.validate({email:a.email,username:a.username,phone:a.phone,password:a.password},{abortEarly:!1}).then(()=>{const r=L.post(A.signupForm,{email:a.email,username:a.username,phone:f+a.phone,password:a.password});U(r,{pending:"Signup in progress, please wait..",success:"Signup successful! ðŸŽ‰",error:"Failed to signup, please try again!"},{autoClose:5e3,position:"top-center"}),r.then(c=>{console.log(c.data),x("")}).catch(c=>{console.error(c),w("error",c,{position:"top-center"})})}).catch(r=>{r.inner.forEach(c=>{w("error",c.message,{position:"top-center",autoClose:3500})})});else{const r=L.post(A.loginForm,{email:a.email,password:a.password});U(r,{pending:"Login in progress, please wait.",success:"Login successful! ðŸŽ‰",error:"Failed to login, please try again!"},{position:"top-center"},()=>{m.current==="admin"?d("/dashboard"):m.current==="customer"&&d("/profile")}),r.then(c=>{const N=c.data.token;i.set("shopify-bliss",N);const l=K(N);l.role==="admin"||l.role==="customer"?m.current=l.role:w("error","Access denied. Role not recognized.")}).catch(c=>{console.error(c)})}},[a,n]);return t.useEffect(()=>{var o;(o=u.state)!=null&&o.messageLogout&&(w("success",u.state.messageLogout),d(u.pathname,{state:{...u.state,messageLogout:void 0},replace:!0}))},[u.state,d,w,u.pathname]),e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"auth",children:[e.jsx("div",{className:"auth-header",children:e.jsx(X,{type:n})}),e.jsxs("div",{className:"auth-content",children:[e.jsx(M,{logo:T,type:n}),e.jsxs("div",{className:`auth-content-core ${n==="signup"?"signup":""}`,children:[e.jsx(ee,{values:a,hidePassword:j,setHidePassword:y,validationPassword:P,handleChange:h,handleForm:k,type:n,phoneCodes:F,selectedCode:f,setSelectedCode:v}),n!=="signup"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"divider"}),e.jsx(se,{type:n,toastDevelop:B})]})]}),n==="signup"?"":e.jsx(S,{className:"auth-content-problems",to:"/404",children:"Can't Log In"})]})]}),e.jsx(O,{})]})}export{ce as default};
