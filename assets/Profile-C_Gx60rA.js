import{a as w,r as t,h as N,e as P,j as e,P as g}from"./index-C4l_2Wgo.js";import{d as E}from"./AuthSupport-D9y-AtW2.js";import{a as A,u as F}from"./ValidationSchema-Obo53iI1.js";function O(){w.defaults.withCredentials=!0;const[u,o]=t.useState({oldPassword:"",newPassword:""}),[m,p]=t.useState(!0),[l,d]=t.useState(!0),[c,b]=t.useState({length:!1,uppercase:!1,lowercase:!1,number:!1,special:!1}),{toastPromise:f,toastMessage:h}=N(),n=t.useCallback(r=>{const{name:s,value:i}=r.target;s==="newPassword"&&b({length:i.length>=8,uppercase:/[A-Z]/.test(i),lowercase:/[a-z]/.test(i),number:/[0-9]/.test(i),special:/[@$!%*?&#^()_\-+=]/.test(i)}),o(x=>({...x,[s]:i}))},[b,o]),a=t.useCallback(r=>{r.preventDefault(),A.validate(u,{abortEarly:!1}).then(()=>{const s=w.put(P.updatePassword,u);f(s,{pending:"Reset password on progress, please wait..!",success:"Reset password has been successfully updated!",error:"Failed to reset password!"},{autoClose:2500,position:"top-center"}),s.then(i=>{console.log(i.data)}).catch(i=>{console.error("Error updating password:",i)})}).catch(s=>{s.inner.forEach(i=>{h("error",i.message)})})},[u,f,h]);return e.jsxs("form",{className:"core",onSubmit:a,children:[e.jsxs("div",{className:"core-input",children:[e.jsxs("div",{className:"core-input-group core-input-pw",children:[e.jsx("label",{htmlFor:"oldPassword",children:"Current Password"}),e.jsx("input",{type:`${m?"password":"text"}`,id:"oldPassword",name:"oldPassword",autoComplete:"off",onChange:n}),e.jsx("span",{className:"material-symbols-outlined",onClick:()=>p(!m),children:m?"visibility_off":"visibility"}),e.jsx("div",{className:"input-border"})]}),e.jsxs("div",{className:"core-input-group core-input-pw",children:[e.jsx("label",{htmlFor:"newPassword",children:"Set New Password"}),e.jsx("input",{type:`${l?"password":"text"}`,id:"newPassword",name:"newPassword",autoComplete:"off",onChange:n}),e.jsx("span",{className:"material-symbols-outlined",onClick:()=>d(!l),children:l?"visibility_off":"visibility"}),e.jsx("div",{className:"input-border"})]})]}),e.jsx(E,{validationPassword:c}),e.jsx("button",{className:"core-button",type:"submit",children:"Save"})]})}const $=[{image:"bear.png"},{image:"bee.png"},{image:"butterfly.png"},{image:"chicken.png"},{image:"elephant.png"},{image:"hedgehog.png"},{image:"hippo.png"},{image:"koala.png"},{image:"ladybug.png"},{image:"lion.png"},{image:"llama.png"},{image:"meerkat.png"},{image:"monkey.png"},{image:"panda.png"},{image:"parrot.png"},{image:"penguin.png"},{image:"polar-bear.png"},{image:"puffer-fish.png"},{image:"sea-lion.png"},{image:"sloth.png"},{image:"snake.png"},{image:"spider.png"},{image:"tiger.png"},{image:"turtle.png"},{image:"weasel.png"}];function C({onClose:u}){w.defaults.withCredentials=!0;const{user:o,toastPromise:m,toastMessage:p,token:l,fetchDashboardData:d}=N(),[c,b]=t.useState(o==null?void 0:o.avatar),[f,h]=t.useState(!1),[n,a]=t.useState({username:"",phoneNumber:""}),r=t.useRef(null),s=t.useCallback(v=>{r.current&&!r.current.contains(v.target)&&h(!1)},[r]);t.useEffect(()=>(f?document.addEventListener("mousedown",s):document.removeEventListener("mousedown",s),()=>{document.removeEventListener("mousedown",s)}),[f,s]),t.useEffect(()=>{o&&a({username:o.username,phoneNumber:o.phone_number})},[o]);const i=t.useCallback(v=>{const{name:j,value:y}=v.target;a({...n,[j]:y})},[n]),x=t.useCallback(v=>{v.preventDefault();const j={avatar:c,username:n.username,phoneNumber:n.phoneNumber};F.validate(j,{abortEarly:!1}).then(()=>{const y=w.put(P.userId,j,{headers:{Authorization:`Bearer ${l}`}});m(y,{pending:"Updating profile data on progress, please wait..!",success:"Data has been successfully updated!",error:"Failed to update data!"},{autoClose:3e3,position:"top-center"},()=>{u(),d()})}).catch(y=>{y.inner.forEach(D=>{p("error",D.message)})})},[c,n,l,m,u,d,p]);return e.jsxs("form",{className:"core",onSubmit:x,children:[e.jsxs("div",{className:"core-avatar",children:[e.jsxs("div",{className:"core-avatar-selected",children:[e.jsx("img",{src:`/avatar/${c}`,alt:"Avatar's User"}),e.jsx("span",{onClick:()=>h(!0),children:"Select Avatar"})]}),f&&e.jsx("div",{className:"core-avatar-list",ref:r,children:$.map((v,j)=>e.jsx("img",{src:`/avatar/${v.image}`,alt:"Avatar List",onClick:()=>{b(v.image),h(!1)}},j))})]}),e.jsx("div",{className:"core-role"}),e.jsxs("div",{className:"core-input",children:[e.jsxs("div",{className:"core-input-group",children:[e.jsx("label",{htmlFor:"username",children:"Username"}),e.jsx("input",{type:"text",id:"username",name:"username",autoComplete:"off",value:n.username,onChange:i}),e.jsx("div",{className:"input-border"})]}),e.jsxs("div",{className:"core-input-group",children:[e.jsx("label",{htmlFor:"phoneNumber",children:"Phone Number"}),e.jsx("input",{type:"number",id:"phoneNumber",name:"phoneNumber",autoComplete:"off",value:n.phoneNumber,onChange:i}),e.jsx("div",{className:"input-border"})]})]}),e.jsx("button",{className:"core-button",type:"submit",children:"Save"})]})}C.propTypes={onClose:g.func};function k({type:u="form",titleModal:o,descModal:m,children:p,onClose:l=null,onOpen:d=null}){return d?e.jsx(e.Fragment,{children:e.jsx("div",{className:"overlay-modal-dashboard",onClick:l,children:u==="form"?e.jsxs("div",{className:"modal-dashboard",onClick:c=>{c.stopPropagation()},children:[e.jsx("span",{className:"modal-dashboard-title",children:o}),e.jsx("span",{className:"material-symbols-outlined modal-dashboard-close",onClick:l,children:"close"}),p]}):e.jsxs("div",{className:"confirm-dashboard",onClick:c=>{c.stopPropagation()},children:[e.jsx("span",{className:"confirm-dashboard-title",children:o}),e.jsx("span",{className:"confirm-dashboard-desc",children:m}),p]})})}):null}k.propTypes={type:g.string,titleModal:g.string,descModal:g.string,children:g.node,onClose:g.func,onOpen:g.func};function S({setCurrentSubmenu:u}){w.defaults.withCredentials=!0;const[o,m]=t.useState(new Array(6).fill("")),p=t.useRef(null),{toastMessage:l,toastPromise:d,user:c}=N(),b=t.useCallback((n,a)=>{const r=n.target.value.replace(/[^0-9]/g,"");if(r.length<=1){const s=[...o];s[a]=r,m(s),r&&a<5&&document.getElementById(`code-input-${a+1}`).focus()}},[o]),f=n=>{n.preventDefault();const a=n.clipboardData.getData("text").trim();if(/^\d{6}$/.test(a)){const r=a.split("");m(r),document.getElementById("code-input-5").focus()}else l("error","Invalid code format. Please paste 6 digits.")},h=t.useCallback(n=>{n.preventDefault();const a=o.join("");if(a.length===6){const r=w.post(P.verifyOtpPassword,{email:c.email,otp:a});d(r,{pending:"Reset password in progress, please wait..",success:"Reset password verified successfully! ðŸŽ‰",error:"Failed to verify reset password, please try again!"},{position:"top-center"},()=>{p.current===!0&&u("d86578b0-4497-4d43-bdad-0f50af1011aa")}),r.then(s=>{p.current=s.data.success}).catch(s=>{console.error(s)})}else l("error","Please enter all 6 digits.")},[o,u,d,l,c.email]);return e.jsxs("form",{className:"recovery-dashboard",onSubmit:h,children:[e.jsx("div",{className:"recovery-dashboard-text",children:"Please check your email inbox for a 6-digit verification code we have sent to your email address. Enter the code in the field below to confirm your email and complete the reset password process."}),e.jsx("div",{className:"recovery-dashboard-wrapper",children:o.map((n,a)=>e.jsx("input",{id:`code-input-${a}`,className:"code-number",type:"text",maxLength:"1",value:n,onChange:r=>b(r,a),onKeyDown:r=>{r.key==="Backspace"&&!o[a]&&a>0&&document.getElementById(`code-input-${a-1}`).focus()},onPaste:f,autoComplete:"off"},a))}),e.jsx("button",{className:"recovery-dashboard-button",children:"Submit Code"})]})}S.propTypes={setCurrentSubmenu:g.func};function _({onClose:u,onOpen:o}){w.defaults.withCredentials=!0;const{submenus:m,toastPromise:p,user:l}=N(),[d,c]=t.useState(m.filter(s=>s.menu_id==="6556df8f-7cd6-4848-b39f-1e6ab4973311"&&s.default===!0)[0].sub_menu_id),[b,f]=t.useState(!1),[h,n]=t.useState(!1),a=t.useCallback(s=>{s==="d86578b0-4497-4d43-bdad-0f50af1011aa"&&!h?f(!0):c(s)},[h]),r=t.useCallback(s=>{s.preventDefault(),c("a14736d9-7bcc-4eef-9be3-2015223cc5ed");const i=w.post(P.sendOtpPassword,{email:l.email});p(i,{pending:"Sending OTP password on progress, please wait..!",success:"OTP password sent successfully.",error:"Failed to send OTP password."},{position:"top-center",autoClose:2500},()=>{f(!1),n(!0),setTimeout(()=>{n(!1)},3e4)}),i.then(x=>{console.log(x.data)}).catch(x=>{console.error(x)})},[p,l.email]);return o?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"overlay-modal-menu",onClick:()=>{u()},children:e.jsxs("div",{className:"modal-menu",onClick:s=>{s.stopPropagation()},children:[e.jsxs("div",{className:"modal-menu-nav",children:[e.jsx("div",{className:"modal-menu-nav-title",children:"Menu"}),m.filter(s=>s.menu_id==="6556df8f-7cd6-4848-b39f-1e6ab4973311"&&s.sub_menu_id!=="a14736d9-7bcc-4eef-9be3-2015223cc5ed").map(s=>e.jsx(e.Fragment,{children:e.jsxs("div",{className:`modal-menu-nav-item ${s.sub_menu_id===d?"active":""}`,onClick:()=>a(s.sub_menu_id),children:[e.jsx("div",{className:"name",children:s.name}),e.jsx("div",{className:"border-effect"})]},s.sub_menu_id)})),h&&e.jsx(e.Fragment,{children:m.filter(s=>s.menu_id==="6556df8f-7cd6-4848-b39f-1e6ab4973311"&&s.sub_menu_id==="a14736d9-7bcc-4eef-9be3-2015223cc5ed").map(s=>e.jsx(e.Fragment,{children:e.jsxs("div",{className:`modal-menu-nav-item ${s.sub_menu_id===d?"active":""}`,onClick:()=>a(s.sub_menu_id),children:[e.jsx("div",{className:"name",children:s.name}),e.jsx("div",{className:"border-effect"})]},s.sub_menu_id)}))})]}),e.jsxs("div",{className:"modal-menu-content",children:[e.jsxs("div",{className:"header",children:[e.jsxs("span",{className:"header-title",children:["Profile â€”"," ",d==="0977a7d1-7ee9-4b68-8e3d-edad0ef87a56"?"Bio":d==="d86578b0-4497-4d43-bdad-0f50af1011aa"?"Password":"Verify OTP"]}),e.jsx("span",{className:"header-close material-symbols-outlined",onClick:u,children:"close"})]}),d==="0977a7d1-7ee9-4b68-8e3d-edad0ef87a56"?e.jsx(C,{onClose:u}):d==="d86578b0-4497-4d43-bdad-0f50af1011aa"&&h?e.jsx(O,{}):e.jsx(S,{setCurrentSubmenu:c})]})]})}),e.jsx(k,{type:"confirm",titleModal:"Are you sure you want to reset password?",descModal:"If you sure want to change your password, please check your email for a verification code.",onClose:()=>{f(!1)},onOpen:b,children:e.jsxs("div",{className:"confirm-dashboard-action",children:[e.jsx("div",{className:"cancel",onClick:()=>{f(!1)},children:"cancel"}),e.jsx("div",{className:"confirm",onClick:r,children:"reset"})]})})]}):null}_.propTypes={onClose:g.func,onOpen:g.bool};const B=Object.freeze(Object.defineProperty({__proto__:null,default:_},Symbol.toStringTag,{value:"Module"}));export{k as M,_ as P,B as a};
