import{a as f,r as u,u as E,b as P,e as g,f as v,t as d,j as t,Q as b,P as x}from"./index-STaWKzCp.js";import{l as N}from"./black-logo-KPU1N9jl.js";import{A as C,a as D}from"./AuthSupport-DSR2MxIb.js";function V({typeMain:i=null}){f.defaults.withCredentials=!0;const[n,m]=u.useState(new Array(6).fill("")),p=u.useRef(null),y=u.useRef(null),c=E(),l=P(),h=u.useCallback((r,e)=>{const s=r.target.value.replace(/[^0-9]/g,"");if(s.length<=1){const o=[...n];o[e]=s,m(o),s&&e<5&&document.getElementById(`code-input-${e+1}`).focus()}},[n]),j=r=>{r.preventDefault();const e=r.clipboardData.getData("text").trim();if(/^\d{6}$/.test(e)){const s=e.split("");m(s),document.getElementById("code-input-5").focus()}else d("error","Invalid code format. Please paste 6 digits.")},w=u.useCallback(r=>{var e;if(r.preventDefault(),i==="verify"){const s=n.join("");if(s.length===6){const o=f.post(g.verifyEmail,{code:s,email:l.state.email});v(o,{pending:"Verification in progress, please wait..",success:"Email verified successfully! ðŸŽ‰",error:"Failed to verify email, please try again!"},{position:"top-center"},()=>{p.current===!0&&c("/login")}),o.then(a=>{p.current=a.data.success}).catch(a=>{console.error(a)})}else d("error","Please enter all 6 digits.")}else{const s=n.join("");if(s.length===6){const o=f.post(g.verifyOtpPassword,{email:(e=l.state)==null?void 0:e.email,otp:s});v(o,{pending:"Reset password in progress, please wait..",success:"Reset password verified successfully! ðŸŽ‰",error:"Failed to verify reset password, please try again!"},{position:"top-center"},()=>{var a;y.current===!0&&c("/reset-password",{state:{messageNoEmail:(a=l.state)==null?void 0:a.email}})}),o.then(a=>{y.current=a.data.success}).catch(a=>{console.error(a)})}else d("error","Please enter all 6 digits.")}},[i,n,c,l.state]);return u.useEffect(()=>{i==="verify"&&!l.state?c("/login",{state:{messageNoEmail:"Email is missing. Please go back to the previous step and ensure your email is entered correctly!"}}):i==="verify-password"&&!l.state&&c("/recovery",{state:{messageNoEmail:"Email is missing. Please go back to the previous step and ensure your email is entered correctly!"}})},[c,l.state,i]),t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"verify",children:[t.jsx("div",{className:"verify-header",children:t.jsx(C,{type:i,classDiff:"verify"})}),t.jsxs("div",{className:"verify-content",children:[t.jsx(D,{logo:N,type:i,classDiff:"verify"}),t.jsxs("form",{className:"verify-content-core",onSubmit:w,children:[t.jsx("div",{className:"verify-content-core-wrapper",children:n.map((r,e)=>t.jsx("input",{id:`code-input-${e}`,className:"code-number",type:"text",maxLength:"1",value:r,onChange:s=>h(s,e),onKeyDown:s=>{s.key==="Backspace"&&!n[e]&&e>0&&document.getElementById(`code-input-${e-1}`).focus()},onPaste:j,autoComplete:"off"},e))}),t.jsx("button",{className:"verify-content-core-button",children:"Submit Code"})]})]})]}),t.jsx(b,{})]})}V.propTypes={typeMain:x.string};export{V as default};
